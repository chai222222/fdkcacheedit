{"version":3,"sources":["../../src/usecases/Base.js"],"names":["Base","val","undefined","length","parseInt","e","str","test","zaico","title","res","exec","_isLimitStr","limitIndex","_optIndex","OPTION_NAMES","LIMIT","optional_attributes","value","targetName","Array","isArray","findIndex","name","idx","push","KEYWORD"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;;;;;IAEqBA,I;;;;;;;kCAOL,CACb;;;+BAEU;AACT,aAAO,KAAP;AACD;;;8BAES,CACT;;;0BAEKC,G,EAAK;AACT,UAAI,OAAOA,GAAP,KAAe,QAAnB,EAA6B,OAAOA,GAAP;AAC7B,UAAI,OAAOA,GAAP,KAAe,QAAnB,EAA6B;AAC3B,eAAOC,SAAP;AACD;AACD,UAAID,IAAIE,MAAJ,KAAe,CAAnB,EAAsB,OAAO,CAAP;AACtB,UAAI;AACF,eAAOC,SAASH,GAAT,EAAc,EAAd,CAAP;AACD,OAFD,CAEE,OAAOI,CAAP,EAAU;AACV,eAAOH,SAAP;AACD;AACF;;;gCAEWI,G,EAAK;AACf,aAAOA,OAAO,2BAA2BC,IAA3B,CAAgCD,GAAhC,CAAd;AACD;;;qCAEgBE,K,EAAO;AACtB,UAAI,OAAOA,MAAMC,KAAb,KAAuB,QAAvB,IAAmC,CAACD,MAAMC,KAA9C,EAAqD,OAAO,KAAP;AACrD,UAAMC,MAAM,aAAaC,IAAb,CAAkBH,MAAMC,KAAxB,CAAZ;AACA;AACA,aAAOC,OAAO,KAAKE,WAAL,CAAiBF,IAAI,CAAJ,CAAjB,CAAd;AACD;;;8BAESF,K,EAAO;AACf,UAAMK,aAAa,KAAKC,SAAL,CAAeN,KAAf,EAAsBR,KAAKe,YAAL,CAAkBC,KAAxC,CAAnB;AACA,aAAOH,cAAc,CAAd,IAAmBL,MAAMS,mBAAN,CAA0BJ,UAA1B,EAAsCK,KAAzD,IAAkE,EAAzE;AACD;;;8BAESV,K,EAAOW,U,EAAY;AAC3B,aAAOC,MAAMC,OAAN,CAAcb,MAAMS,mBAApB,IACHT,MAAMS,mBAAN,CAA0BK,SAA1B,CAAoC;AAAA,YAAEC,IAAF,QAAEA,IAAF;AAAA,eAAYA,SAASJ,UAArB;AAAA,OAApC,CADG,GAEH,CAAC,CAFL;AAGD;;;8BAESX,K,EAAOW,U,EAAY;AAC3B,UAAMK,MAAM,KAAKV,SAAL,CAAeN,KAAf,EAAsBW,UAAtB,CAAZ;AACA,aAAOK,MAAM,CAAN,GAAUtB,SAAV,GAAsBM,MAAMS,mBAAN,CAA0BO,GAA1B,EAA+BN,KAA5D;AACD;;;4BAEOV,K,EAAOW,U,EAAYD,K,EAAO;AAChC,UAAIE,MAAMC,OAAN,CAAcb,MAAMS,mBAApB,CAAJ,EAA8C;AAC5C,YAAMO,MAAMhB,MAAMS,mBAAN,CAA0BK,SAA1B,CAAoC;AAAA,cAAEC,IAAF,SAAEA,IAAF;AAAA,iBAAYA,SAASJ,UAArB;AAAA,SAApC,CAAZ;AACA,YAAIK,OAAO,CAAX,EAAc;AACZhB,gBAAMS,mBAAN,CAA0BO,GAA1B,EAA+BN,KAA/B,GAAuCA,KAAvC;AACA;AACD;AACF,OAND,MAMO;AACLV,cAAMS,mBAAN,GAA4B,EAA5B;AACD;AACDT,YAAMS,mBAAN,CAA0BQ,IAA1B,CAA+B,EAAEF,MAAMJ,UAAR,EAAoBD,OAAOA,KAA3B,EAA/B;AACD;;;;;;AApEkBlB,I,CAEZe,Y,GAAe;AACpBC,SAAO,UADa;AAEpBU,WAAS;AAFW,C;kBAFH1B,I","file":"Base.js","sourcesContent":["import fs from 'fs';\nimport path from 'path';\n\nexport default class Base {\n\n  static OPTION_NAMES = {\n    LIMIT: '賞味期限（消費）',\n    KEYWORD: 'キーワード',\n  }\n\n  description() {\n  }\n\n  isTarget() {\n    return false;\n  }\n\n  editOne() {\n  }\n\n  toNum(val) {\n    if (typeof val === 'number') return val;\n    if (typeof val !== 'string') {\n      return undefined;\n    }\n    if (val.length === 0) return 0;\n    try {\n      return parseInt(val, 10);\n    } catch (e) {\n      return undefined;\n    }\n  }\n\n  _isLimitStr(str) {\n    return str && /^\\d+年\\d+月|^\\d{8}$|^期限なし$/.test(str);\n  }\n\n  _isLimitIntTitle(zaico) {\n    if (typeof zaico.title !== 'string' || !zaico.title) return false;\n    const res = /^【([^】]+)】/.exec(zaico.title);\n    // if (res) console.log('******', res[0]);\n    return res && this._isLimitStr(res[1]);\n  }\n\n  _getLimit(zaico) {\n    const limitIndex = this._optIndex(zaico, Base.OPTION_NAMES.LIMIT);\n    return limitIndex >= 0 && zaico.optional_attributes[limitIndex].value || '';\n  }\n\n  _optIndex(zaico, targetName) {\n    return Array.isArray(zaico.optional_attributes)\n      ? zaico.optional_attributes.findIndex(({name}) => name === targetName)\n      : -1;\n  }\n\n  _optValue(zaico, targetName) {\n    const idx = this._optIndex(zaico, targetName);\n    return idx < 0 ? undefined : zaico.optional_attributes[idx].value;\n  }\n\n  _optSet(zaico, targetName, value) {\n    if (Array.isArray(zaico.optional_attributes)) {\n      const idx = zaico.optional_attributes.findIndex(({name}) => name === targetName);\n      if (idx >= 0) {\n        zaico.optional_attributes[idx].value = value;\n        return;\n      }\n    } else {\n      zaico.optional_attributes = [];\n    }\n    zaico.optional_attributes.push({ name: targetName, value: value });\n  }\n}\n"]}